webpackJsonp([1],{"20m4":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEUAAABQCAYAAABPlrgBAAAAAXNSR0IArs4c6QAAC4FJREFUeAHtnH9wXUUVx5ufhfyokCiKMIxAa8qo+IcIMyDQljJALSD+qDpJU5LmR4NUtFimTONYtJUyNnXKD5MmTdKkZZQ4/BCxFqcaYAoqTgWmokkjBKkBpKSVOklofvo5b94t+/buvnfvu+/lhZl3Z253z9lzds9+9+zu2b0vnTUr/aQRSCOQRiCNQFIRyEhq7UmsvLu7O/vw4cNFJ06cKJ6amsrk7a+trR1ORJMfKFDa29tPA4RvAMAXMzIyFpHmOSBAT5F/A96TpLtWrVr1dJjniHhOPxCgAMYpo6OjqycnJ++kZ6d76R2A9GRmZq6uqanZ50VelZnxoLS2tpaMjY09jgd8UjXcax5wHiooKKgpKys77lnHq2Aq5Jqbm6/BO34BIKcFaR9gXpw9e/Z1FRUVb3mpZ8Z6SmNj4wI68zsAybF1hPJ3KH+LNBeZc2PI9gPMpV6AmZGgbN++/Xw6+DxvkQ4IAIzBb8zKympnvXjRKe/q6so9duzYEjxrNbxFDl9N0X2qqKho8bJlyyZUvp6fcaB0dnbmDw0N/QVDL3AZm5FxkMXzq4BxSC9T6aampq8DXDO8OSpf8uhvYOu+S+erdKZKzIT8yMhIA3aYAOnOycm5LBYg0ge244fwiit4/6P3CbDWtrW1fUTnq/SMAoWFdSnuX6saGM730sGbVq5c+T9DmZEFMC8BwFcoHFcF4OWzvd+u8vT8jAGFaXPGxMREq24gYAzn5ubeiMu/q5fFouvq6p5FZotB7mbAsS4dMwaU4eHhHRh/ht4BjF+Dh/TqfK90Xl7eFgFWlafOj+7YseMzKk/NzwhQ2H6rMfR61TDJ05nfMNrbdb4fesWKFYPId+s6TNMFOs+hUw4KIzaXzv/UMUhJj7DtrlToIFmZRhEPoJwZwVCIlIIiJ93x8fHdeEm+YlMoCyBV1dXVrt1Dl/NCU/87uhxbs/UMlVJQDh06tB6DL9ENxnNa2Hof1/nx0gCQrevSrrXv1gK9kkTTRK2X4ML1hnr/yeL4XQM/CGueQbnfwAuxUgKKRK2M1C4siBhBPGQiOzt7eXl5+ZDN4Hj4gH+VQe9VAy/ESgkobL9bAcU0eptYR/5kMzYePh4pW++Fqi7g0/zUfpWn5qcdFM4l12NQjWqE5DH0+ZKSkh/pfIdG7xa27lvRtQZdjqyaIr9JpSUvgLDVD+h8h55WUCRqxSAJ0iIeAJHpUrZw4cLxiIIwQfj/KbINvPcBzm8Zfet2quoju4T2XPEPMg+qcnp+WkGJErXezlmlTzdOaLkSYE14kM6dEi6Xi6eDACXnGuvT0dFRTKFpAF4pLi5utypSMG2gMLo1llF7IlrUevTo0Y3ofVbrRDHAXK7xIkhO283ouTwK3lruU0YjhDViWkDBjedhzFatbSGP5OfnW6NWvOFK9FwnWqbby9yirTPUF2Kx9siB78t6OXp7GYBHdb5OJx0UiVppdBdGGqNWtt+3daOExrM+hDd0ko2wkY6NEoyVca34nkmvpaXlXGTuNZQNch9jHQBVPqJBtSBR+Z6ennoA8R21onM/7zm6HfC+r15DquWUZXL90ElaqPIlz7GhltP2GzrfRCcVFEZbwFhvaDhq1Ir7L6NjZboeHvAMC7LpfiQkynRbh94XdD3oDoB82MA3spIGikStuP9uWnVFreL+tqgVQM5Cp8lg7XGi3XKAmTSUzWLafA5ANuhlyPcXFhZ+W+dHo5MGikStNDxXbxzDN3KL9medLzRlEpjt5HWdYHH/W6uqqv5Fmeth2z6VaSOn7RytcBJQyv18CBP9iFHUKoybZLeJFrVutFWM+99G2WK9nI79EvffpfMdmm37JwAy36GdFL17GID9Du01TbinBIlamW6bdcPp2ADTZpXOd2gG4FoA+ZZDOyl6f+X9gUP7SRMOCt9s5PLZddeKgWtiRa3ozVaNR2eK9edmps1Rle/kw1Frm0Mr6QjTrQwvGVN4nrMJBUWiVlpeamj9CQyUj1PGxxK1iuy9TJt9RiWYtqiVojs4bf/DpheLnzBQokStbycjaqW9CqaNK2qlw0/ikQ/E6ni08oSAEo5ajXetTIGqZEStdGqboWODTLcKmXaGMs+shIASjlov1lvFuGZG7dc636EZ6Qd4fUWtbL9ZbL9ybHBFrbRXwzR906k/3jQwKARbF2NMvcEAiVrXGPghFu4vH8FLDeVPR4taBwcHJWq9TNfDhp3oPaLz46EDgYJx2JIho52lNT4eLWol+jwbnUZNR27f3uXQtoLUGrVS5tpm4fWj5ytq1dtW6UCgsNvcQOcuUisM5zfhxtaoFfffiZwraoUXd9Tq5+N72EZrEjSi/aah5hfmz59vjVqZNt9B5ypdj9Huwv1363yHtkWtlG9mAHxHrU69pjSQp+Aln9crJWjaYLtr5RPpp5G/W9cBkAEObXFFrUzTDXp9QelAoNCZj+sGANRzOk9ouWuVT6RkjVFraWnpMZOeRK3UabpTHaH9UrwkrqjV1JbDCwQKxh53KnJSeJ9w8moaJWrdFiNqbaGej6l1hfN3AEiPgR+YFQgUWv+bwYIGuUtR+eHt13bXeqcqq+bDUetNKk/yeIjctd6v8xNFZwesSC6BF6l14ClXcCg8QIfknlQ+OF0Nr5Y0YgDomNyol9ruWvld2nn8DMsYtaJbiW7SnghD/bbC95NWDJSO608JQEj88hivHOtd4KNXz27zkq4otEStAGK8a0UvIVGrqV2H5wkU+W28o6CmfD+RxW45vHGVHyuPzq9YRxpsctMRtdraFr4nUPjLiacI1O5jBAv0yljsuumkxCsjepmF/gPhfyk6KY1aLbaF2DE/VgPG17gR6xJpOvIacUG1abcgdL+QSHUb02VBqGbtH3SHKNtKYPdDWxwD6KfiJS+gWqKqozuB7pUsrs+q/GTlo4IiVwK9vb1/x6B5qgEYuY714B6V5+TlVh1wvoTOBfAKkD1Cfj9f9B6prKw84siZUhZnWYduMZT9GEDWG/hJYbkWQLWVvr4+2TkiAAmX/1GVU/PceB2AltfXw6X1dYBpAuRAMqLWaMZFXVOYNqYYYQ9e8ky0Sv2WMUU/DCBtBr0ROW0nI2o1tHWSZQUFD5G/y7vxpOT7GVPI/X5pHDnakftbV9QKIGuTFbVGM9MKCvP7HBQjbuVZH97j3ROtQr9lTJtKQDF55F4ACXTX6tcWR94KCqN0tiOkpK9g6LBCB8pK1Co7lqGSQcCvNPCnhWUFhdE7S7cA3us6L15aolbiH/nq54p94FUD/pvx1h1UzwoKnuKKUhk9Y2QbjxGcmuUgeKmuSxvtXn5Yo+slkraCQiOukcJTXPcn8RjDenURddnuWm+Lp85E6lhBweh/GxoqCf9UwlDkjcX2m0fdu5GOiJHwEIlalyfyrtWbRW4pKyjM6dcxtE9XgVeu8/zQxD5bkI8I40WfejdPVxgfy14rKGHFxwwVfC/8YdtQFJ3FtKlAos4gJRHwXQZ+SlhRQWGx7cCqiNMsLl7Eh+2fy+7hx2LikcXINxl0UhK1Guw4yYoKCqfhl3FrASbiAZir2T0e1a8dI4QUgnWommmzB71chR3KUv8apmpS7lr1trzSGbEEwwvrQeRO12Xp0Gvw1vGb+odN1wHhXeZuZMRLXA/68q251lWQYkZMUMQ+cX1Gei8jbZsyEoHuQ/RV3gneM3kXIH8+qfFBXi6nrsFLxowCKWR6AkXskylAJxqjAOOnG8/NmTNnqe1bj5+KkiHrGRRpnOmwhET+l4rCAMa0ceFdF+v38QHqD6zqCxRpTf46lP/PpIHsDX5ax8sGALOeWGSnH71UyPoGxTGSyHQhnZTvv0tJ8xy+ngKG7CwtXEf+zPaNR9dJNR03KI7hsi3zQ+LLAWYucc15LMjyg97/Uj5A+nuJjB3ZdJpGII1AGoE0AmkEQgj8H3JuDPHSpg/jAAAAAElFTkSuQmCC"},EvdB:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAABFdJREFUeJztmdFrW1Ucx7/nl9vc2TWWzonSjRXUB4Xp26CMYJY11RFU6lj6JP4PexFfdG7zD9ibiOCenIIvzooUcROJpLegg2F7N9icoJC24Lo2adIkzT3Hh3m3LC7Nufeek3sJ+T4l6bnnnM+H3zk9hwsMMkikI86AdPavtfOgWc9kRld/S879dWryCV1jRFpAzaxNA8ga28ZlXRIiLYCBpwGAMUwbNfpWh4RIC4CgI+5HBsrokBBpARz8pdbvOiREVsB6JjNKRCPtvzNQxqiSso0xsgK2zK3/wbthRFOqJERSgEiljCEWu7BbG1USIidApFLGaqL5JcBOdWvLiKZEBQtLr03u8zse8/ugjniBb0210bi3DXrh8A/WutcxI1MBfuEBYDgeH9upN34qTHpfDpEQcB/eueQHHgDWKlVsNuqv1FH+zquE0JfAQ3jk/Dy/Vqlio1Z/2J/AVROJN45a1rbM86FWgGp4AGAMxxuiPCdbCaFVgA74R8JxJc4Sb3arhFAqQKRSRnHE+QK64AGAMCVTCT2vABeeGGb9PC8F/2h+jIvEW50qoacCQoB301FCzwSECO/msRJ6sgeIXC4WMjwAZGqsdLl9T9AuQORysWJ15VLI8AAAAptuoPRp629KlsCfqdSe4SfrBwVi+7lgZoyznSY1182mU6zH4p+FBs+xxYn/TQK2AC0KQVfTi79fY4Bwm/gWUMwm3wHjWQg6IoDniNRWUyB4IT5KWfa5VtBOMfyNAAD4hzGcBIOpeicNCn/Mss/KNg8092I2eYIR/wYgM0g/reklPKBgD1ApISD8mWOWfc7rY0qqV4WEMOABhQehIBLCggcUnwT9SAgTHlB8EBr//pd5wWkG4FJEQeAFxIdB4QFNdwGZSggKn16wz/ueYEu0XYZ2kxAVeEDzbbCYTZ4Q5MwRYg8OXFGCB4CYys7ak/38q6M7w4nDiTs39jOwgPD4IL1gf6x4ivoEXMkX3gUXF+vjE0/XzJFb20vXRjdrdV+b7n34ZeXwgCYBLjyIqOk44td7peUbzxy4e/D2zacYhKf7h054QIOAdvgl286XquVXnaH4+Mqh5wuHbtnPgsldwnTDA4rPAZ3g//tzuTY8+r5gYgYcEhsBr+iGBxQK6AbPOb1+/r3TC2nLnpeTQHvzyZfHVM2v4ygqOpGFd9vLS0D0BXiFdyMjwdlpav03DQQU4BfeTTcJQhhSLziDxLeAoPBudpNg0t67fucnG18CVMG7ebwEvib7ijtIPAtQDe+mXYIQtOy1Dz/xJEAXvJtWCYxh0W8/XiItQDe8G1cCA58P2pdMpK7DvYIPI10F5PP5sRqnNSIa6jd4QGIJNEBv9ys8IPFqTIBmnT6FB7osgflCYZ/R4CvXbdty4TmwCk4n+wEe6LIEYg7NXLdta6NafhECn3CG41QuHegXeKDLEvjjzu2NUmXz7M2JiZ+/np11ejWpQQYZZJBBBhmkJ/kXMrKNai1ZirQAAAAASUVORK5CYII="},NHnr:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("7+uW"),o={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]};var i=s("VU/8")({name:"App"},o,!1,function(e){s("gx9n")},null,null).exports,r=s("/ocq"),n=s("fZjL"),m=s.n(n),l=s("Dd8w"),u=s.n(l),c=(s("P4BZ"),{render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e.message.userName!=e.userName?s("div",[s("div",{staticClass:"messageBox"},[s("img",{staticClass:"messageBox__user",attrs:{src:"https://lorempixel.com/40/40/",draggable:"false"}}),e._v(" "),s("div",{staticClass:"messageBox__content"},[s("div",{class:e.gmLabel},[e._v(e._s(e.message.userName))]),e._v(" "),"text"==e.message.type?s("div",{staticClass:"messageBox__message"},[s("div",{staticClass:"messageBox__text"},[e._v(e._s(e.message.message))]),e._v(" "),s("div",{staticClass:"messageBox__readMore",on:{click:function(t){e.readMore(t)}}},[e._v("顯示更多")])]):e._e(),e._v(" "),"image"==e.message.type?s("div",{staticClass:"messageBox__image"},[s("img",{attrs:{src:e.message.message}})]):e._e()]),e._v(" "),s("div",{staticClass:"messageBox__time"},[e._v(e._s(e.message.timeStamp))])])]):e._e(),e._v(" "),e.message.userName==e.userName?s("div",[s("div",{staticClass:"messageBox messageBox--self"},[s("div",{staticClass:"messageBox__time"},[e._v(e._s(e.message.timeStamp))]),e._v(" "),s("div",{staticClass:"messageBox__content"},["text"==e.message.type?s("div",{staticClass:"messageBox__message"},[s("div",{staticClass:"messageBox__text"},[e._v(e._s(e.message.message))])]):e._e(),e._v(" "),"image"==e.message.type?s("div",{staticClass:"messageBox__image"},[s("img",{attrs:{src:e.message.message}})]):e._e()])])]):e._e()])},staticRenderFns:[]}),d=s("VU/8")({name:"RoomBody",props:["message","userName"],data:function(){return{manager:"tBjoEkDl47VyGVPm82xeuFWAZQr2"}},computed:{gmLabel:function(){return this.message.uid===this.manager?"messageBox__name gmLabel":"messageBox__name"}}},c,!1,null,null,null).exports,v=firebase.database().ref("/messages/"),g=firebase.database().ref("/notice/"),p=firebase.storage().ref("/images/"),A={name:"ChatRoom",data:function(){return{userNameSet:!1,noticeSet:!1,userName:"",messages:[],lastNotice:"",noticeContent:"",upload:!1,progress:"",user:{uid:"",email:"",auth:!1}}},components:{"room-body":d},methods:{setName:function(){this.userNameSet=!0},setNotice:function(){this.noticeSet=!0},saveName:function(){var e=document.querySelector("#js-userName").value;""!==e.trim()&&(this.userName=e,this.userNameSet=!1)},saveNotice:function(){var e=document.querySelector("#js-notice").value;""!==e.trim()&&(g.push({type:"text",message:e.trim(),timeStamp:this.getTime()}),this.noticeContent=e,this.noticeSet=!1)},getTime:function(){var e=new Date,t=e.getHours(),s=e.getMinutes();return(t>=12?"下午":"上午")+" "+t+":"+(s<10?"0"+s:s)},sendMessage:function(e){var t=document.querySelector("#js-userName"),s=document.querySelector("#js-message");return!e.shiftKey&&(s.value.length<=1&&""===s.value.trim()?(e.preventDefault(),!1):(v.push({userName:t.value,type:"text",message:s.value,timeStamp:this.getTime(),uid:this.user.uid,auth:this.user.auth}),s.value="",e.preventDefault(),!1))},sendImage:function(e){var t=this,s=document.querySelector("#js-userName"),a=e.target.files[0],o=Math.floor(Date.now()/1e3)+"_"+a.name,i=document.querySelector("#js-progressBar"),r=p.child(o).put(a,{contentType:"image/*"});r.on(firebase.storage.TaskEvent.STATE_CHANGED,function(e){var s=Math.floor(e.bytesTransferred/e.totalBytes*100);s<100&&(t.upload=!0,t.progress=s+"%",i.setAttribute("style","width:"+s+"%"))},function(e){v.child("bug/").push({userName:s.value,type:"image",message:e.code,timeStamp:t.getTime()})},function(){var e=r.snapshot.downloadURL;v.push({userName:s.value,type:"image",message:e,timeStamp:t.getTime()}),t.upload=!1})},readMore:function(e){e.target.previousElementSibling.setAttribute("style","max-height: 100%;"),e.target.setAttribute("style","display: none;")}},mounted:function(){var e=this;v.on("value",function(t){var s=t.val();e.messages=s}),g.on("value",function(t){var s=t.val(),a=u()({},s),o=a[m()(a).pop()];e.lastNotice=o}),firebase.auth().onAuthStateChanged(function(t){t&&(e.user={uid:t.uid,email:t.email,auth:!0}),console.log("登入狀態",e.user.auth)})},updated:function(){document.querySelectorAll(".messageBox__message").forEach(function(e){e.offsetHeight>300&&e.querySelector(".messageBox__readMore").setAttribute("style","display: block")});var e=document.querySelector("#js-roomBody");e.scrollTop=e.scrollHeight}},h={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("div",{staticClass:"name"},[a("h3",[e._v("Name："+e._s(e.userName))]),e._v(" "),a("div",{staticClass:"reset",on:{click:function(t){e.setName()}}},[e._v("Reset Name")])]),e._v(" "),a("div",{staticClass:"chatRoom"},[a("div",{staticClass:"roomHead"},[e._m(0),e._v(" "),a("img",{staticClass:"roomHead__img",attrs:{src:"https://lorempixel.com/50/50/",draggable:"false"}}),e._v(" "),a("div",{staticClass:"roomHead__title"},[e._v("聊天室")]),e._v(" "),a("div",{staticClass:"roomHead__notice"},[e._v(e._s(e.lastNotice.message))])]),e._v(" "),a("div",{staticClass:"roomBody",attrs:{id:"js-roomBody"}},[e._l(e.messages,function(t,s){return a("room-body",{key:s,attrs:{message:t,userName:e.userName}})}),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.upload,expression:"upload"}],staticClass:"messageBox messageBox--self"},[a("div",{staticClass:"messageBox__progress"},[a("div",{staticClass:"messageBox__progress--state",attrs:{id:"js-progressBar"}}),e._v(" "),a("div",{staticClass:"messageBox__progress--number"},[e._v(e._s(e.progress))])])])],2),e._v(" "),a("div",{staticClass:"roomBottom",class:{disable:!e.userName}},[a("div",{staticClass:"roomBottom__tools"},[e.user.auth?a("div",{staticClass:"roomBottom__tool_upload"},[a("input",{attrs:{type:"file",accept:"image/*"},on:{change:function(t){e.sendImage(t)}}}),e._v(" "),a("img",{attrs:{src:s("20m4")}})]):e._e(),e._v(" "),e.user.auth?a("div",{staticClass:"roomBottom__tool_pin",on:{click:function(t){e.setNotice()}}},[a("img",{attrs:{src:s("EvdB")}})]):e._e()]),e._v(" "),a("div",{staticClass:"roomBottom__input"},[a("textarea",{staticClass:"roomBottom__input__textarea",class:{disable:!e.userName},attrs:{id:"js-message"},on:{keydown:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.sendMessage(t)}}})])])]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.userNameSet||""===e.userName,expression:"userNameSet || userName === ''"}],staticClass:"modal"},[a("div",{staticClass:"modal__container"},[e._m(1),e._v(" "),a("div",{staticClass:"modal__body"},[a("input",{staticClass:"userName",attrs:{type:"text",id:"js-userName",maxlength:"20"},domProps:{value:e.userName},on:{keydown:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.saveName()}}}),e._v(" "),a("div",{staticClass:"button",on:{click:function(t){e.saveName()}}},[e._v("設定")])]),e._v(" "),a("footer",{staticClass:"modal__footer"})])]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.noticeSet&&e.user.auth,expression:"noticeSet && user.auth"}],staticClass:"modal"},[a("div",{staticClass:"modal__container"},[e._m(2),e._v(" "),a("div",{staticClass:"modal__body"},[a("input",{staticClass:"userName",attrs:{type:"text",id:"js-notice",maxlength:"20"},domProps:{value:e.noticeContent},on:{keydown:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.saveNotice()}}}),e._v(" "),a("div",{staticClass:"button",on:{click:function(t){e.saveNotice()}}},[e._v("設定")])]),e._v(" "),a("footer",{staticClass:"modal__footer"})])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"roomHead__topButtons"},[t("div",{staticClass:"roomHead__button close"}),this._v(" "),t("div",{staticClass:"roomHead__button minimize"}),this._v(" "),t("div",{staticClass:"roomHead__button zoom"})])},function(){var e=this.$createElement,t=this._self._c||e;return t("header",{staticClass:"modal__header"},[t("h2",{staticClass:"view-title"},[this._v("輸入名稱")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("header",{staticClass:"modal__header"},[t("h2",{staticClass:"view-title"},[this._v("輸入公告")])])}]},f=s("VU/8")(A,h,!1,null,null,null).exports;a.a.use(r.a);var _=new r.a({routes:[{path:"/",name:"ChatRoom",component:f}]});a.a.config.productionTip=!1,new a.a({el:"#app",router:_,components:{App:i},template:"<App/>"})},P4BZ:function(e,t){},gx9n:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.8c9a6055053de7cf948c.js.map